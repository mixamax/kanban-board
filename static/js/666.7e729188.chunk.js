"use strict";(self.webpackChunkproject_planner=self.webpackChunkproject_planner||[]).push([[666],{9666:function(e,t,n){n.r(t),n.d(t,{default:function(){return z}});var s=n(9439),r=n(9503),a=n(2641),i=n(9286),o="TaskPage_names-cont-tasks-column__YhVrS",c="TaskPage_name-tasks-column__HVl12",l=n(1392),d=n(2791),u=n(7689),m=n(1087),p=n(1243),f=n(1678),h=n(9907),k=n(2995),x=n(618),j=n(2426),v=n.n(j),y=n(184),Z=function(e){return e.reduserTascs},g=function(e){var t=e.isModalOpen,n=e.close,r=e.taskId,i=e.projectName,o=e.openComment,c=e.chooseActiveTask,l=(0,x.v9)(Z),u=(0,d.useState)(""),m=(0,s.Z)(u,2),j=m[0],g=m[1];(0,d.useLayoutEffect)((function(){c(r)}),[r]);var b,D,T="",N="",C="",I=0,w="",S="";function O(){var e=v()(C),t=v()(Date.now()),n=t.diff(e,"days");e.add(n,"days");var s=t.diff(e,"hours");e.add(s,"hours");var r=t.diff(e,"minutes");e.add(r,"minutes");var a=t.diff(e,"seconds");return"".concat(n," \u0434\u043d, ").concat(s," \u0447, ").concat(r," \u043c\u0438\u043d, ").concat(a,"\u0441\u0435\u043a")}r&&(N=l[i].tasks[r].taskTitle,C=l[i].tasks[r].startDate,I=l[i].tasks[r].endDate,T=l[i].tasks[r].priority,S=l[i].tasks[r].columnName,b=new Date(C).toLocaleString("ru",{day:"numeric",month:"numeric",year:"numeric",hour:"numeric",minute:"numeric"}),D=I?new Date(I).toLocaleString("ru",{day:"numeric",month:"numeric",year:"numeric",hour:"numeric",minute:"numeric"}):"\u043d\u0435 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430",w=1===T?"\u043d\u0438\u0437\u043a\u0438\u0439":2===T?"\u0441\u0440\u0435\u0434\u043d\u0438\u0439":"\u0432\u044b\u0441\u043e\u043a\u0438\u0439"),(0,d.useEffect)((function(){if("Done"!==S){var e=O(),t=setTimeout(g,1e3,e);return function(){return clearTimeout(t)}}var n=O();g(n)}),[j,S]);var _=[{key:"1",label:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",children:N},{key:"2",label:"\u0414\u0430\u0442\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f",children:b},{key:"3",label:"\u0414\u0430\u0442\u0430 \u043e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u044f",children:D},{key:"4",label:(0,y.jsx)(f.Z,{status:"processing",text:"\u0412 \u0440\u0430\u0431\u043e\u0442\u0435"}),children:j},{key:"5",label:"\u041f\u043e\u0434\u0437\u0430\u0434\u0430\u0447\u0438",children:"3"},{key:"6",label:"\u041f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442",children:w}];return(0,y.jsxs)(p.Z,{title:0===r?"":"".concat(l[i].tasks[r].taskDescription),centered:!0,open:t,onOk:n,onCancel:n,children:[(0,y.jsx)(h.Z,{bordered:!0,items:_,column:1,size:"small"}),(0,y.jsx)(a.ZP,{size:"m",children:"\u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u0434\u0437\u0430\u0434\u0430\u0447\u0443"}),(0,y.jsx)(k.Z,{onClick:o,color:"red",style:{fontSize:"200%",marginTop:"1rem",marginLeft:"1rem",cursor:"pointer",color:"red"}})]})},b=n(3834),D=n(1413),T=n(1515),N=n(668),C=n(322),I=n(9689),w=n(4177),S=n(3855),O=n(6403),_=n(4261),P=function(e){var t=e.closeSubCommentInput,n=e.isSubCommentInputOpen,r=e.parentComment,i=(0,S.I0)(),o=T.Z.useForm(),c=(0,s.Z)(o,1)[0];return(0,y.jsx)(p.Z,{open:n,onOk:t,onCancel:t,children:(0,y.jsxs)(T.Z,(0,D.Z)((0,D.Z)({preserve:!1,form:c},{labelCol:{span:10},wrapperCol:{span:50}}),{},{name:"sub-comment",style:{marginTop:"2rem"},onFinish:function(e){var t=e.comment.text,n=r.id,s=r.taskId;t&&i({type:"addComment",payload:{id:"com-".concat((0,_.Z)()),text:t,parent:n,taskId:s}}),c.resetFields()},children:[(0,y.jsx)(T.Z.Item,{name:["comment","text"],rules:[{required:!0}],children:(0,y.jsx)(N.Z.TextArea,{})}),(0,y.jsx)(O.Z,{children:(0,y.jsx)(a.ZP,{type:"primary",htmlType:"submit",children:"\u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439"})})]}))})},F=I.Z.DirectoryTree,L=function(e){return e.reduserComments},M=function(e){var t,n,r=e.selectedTaskId,i=(0,S.v9)(L),o=(0,d.useState)(!1),c=(0,s.Z)(o,2),l=c[0],u=c[1],m=(0,d.useState)(""),p=(0,s.Z)(m,2),f=p[0],h=p[1],k=function(e){u(!0),h(e)},x=function e(t,n){var s,r,o,c=i.commentsList.filter((function(e){return i[e].parent===t})),l="0-".concat(n);return{title:(s=i[t].text,r=k,o=i[t],(0,y.jsxs)("div",{children:[(0,y.jsx)(w.Z,{title:"",bordered:!1,style:{width:250,marginTop:"1rem"},bodyStyle:{display:"flex",overflow:"hidden",padding:"1rem"},children:(0,y.jsx)("p",{style:{margin:"0",overflow:"auto",overflowWrap:"break-word"},children:s})}),(0,y.jsx)(a.ZP,{onClick:function(){return r(o)},style:{marginTop:"0.4rem"},children:"comment"})]})),key:l,icon:(0,y.jsx)(C.Z,{}),children:(c||[]).map((function(t,n){return e(t,"".concat([l],"-").concat(n))}))}};return i.commentsList?t=(n=i).commentsList.filter((function(e){return n[e].taskId===r})).filter((function(e){return""===n[e].parent})).map((function(e,t){return x(e,t)})):t=[],(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(F,{selectable:!1,height:"70vh",virtual:!1,showLine:!0,showIcon:!1,defaultExpandAll:!0,treeData:t}),(0,y.jsx)(P,{parentComment:f,isSubCommentInputOpen:l,closeSubCommentInput:function(){u(!1)}})]})},q=function(e){var t=e.isCommentOpen,n=e.closeComment,r=e.selectedTaskId,i=(0,S.I0)(),o=T.Z.useForm(),c=(0,s.Z)(o,1)[0];return(0,y.jsxs)(p.Z,{open:t,onOk:n,onCancel:n,children:[(0,y.jsxs)(T.Z,(0,D.Z)((0,D.Z)({preserve:!1,form:c},{labelCol:{span:10},wrapperCol:{span:50}}),{},{name:"comments",style:{marginTop:"2rem"},onFinish:function(e){var t=e.comment.text;t&&r&&i({type:"addComment",payload:{id:"com-".concat((0,_.Z)()),text:t,parent:"",taskId:r}}),c.resetFields()},children:[(0,y.jsx)(T.Z.Item,{name:["comment","text"],rules:[{required:!0}],children:(0,y.jsx)(N.Z.TextArea,{})}),(0,y.jsx)(O.Z,{children:(0,y.jsx)(a.ZP,{type:"primary",htmlType:"submit",children:"\u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439"})})]})),(0,y.jsx)(M,{selectedTaskId:r})]})},z=function(){var e=(0,u.UO)().projectName,t=(0,d.useState)(!1),n=(0,s.Z)(t,2),p=n[0],f=n[1],h=(0,d.useState)(!1),k=(0,s.Z)(h,2),x=k[0],j=k[1],v=(0,d.useState)(!1),Z=(0,s.Z)(v,2),D=Z[0],T=Z[1],N=(0,d.useState)(""),C=(0,s.Z)(N,2),I=C[0],w=C[1],S=(0,d.useRef)(0),O=function(){T(!0)};return(0,y.jsxs)(r.VY,{style:{height:"100%",minHeight:"100%",width:"100%",display:"flex",flexDirection:"column",alignItems:"center",position:"relative"},children:[(0,y.jsx)(m.rU,{to:"/",children:(0,y.jsx)(b.Z,{height:"10em",style:{position:"absolute",left:"2.5rem",top:"2.5rem",fontSize:"200%"}})}),(0,y.jsx)(a.ZP,{onClick:function(){return f(!0)},type:"primary",shape:"circle",icon:(0,y.jsx)(i.Z,{}),size:"large",style:{marginTop:"2rem",boxShadow:"0px 0px 20px 2px rgba(0, 0, 0, .35)",backgroundColor:"green"}}),(0,y.jsxs)("div",{className:o,children:[(0,y.jsx)("span",{className:c,children:"Queue"}),(0,y.jsx)("span",{className:c,children:"Development"}),(0,y.jsx)("span",{className:c,children:"Done"})]}),(0,y.jsx)(l.WH,{projectName:e,setOpenTaskDescriptionModal:function(e){S.current=e,j(!0)}}),(0,y.jsx)(l.K9,{isModalOpen:p,close:function(){f(!1)},projectName:e}),(0,y.jsx)(g,{isModalOpen:x,close:function(){j(!1)},taskId:S.current,projectName:e,openComment:O,chooseActiveTask:function(e){w(e)}}),(0,y.jsx)(q,{isCommentOpen:D,closeComment:function(){T(!1)},openComment:O,selectedTaskId:I})]})}},1392:function(e,t,n){n.d(t,{t:function(){return i},FA:function(){return p},K9:function(){return F},WH:function(){return N}});var s=n(4177),r=n(1087),a=n(184),i=function(e){var t=e.name,n=e.description,i=e.linkName;return(0,a.jsx)(r.rU,{to:"/task/".concat(i),children:(0,a.jsx)(s.Z,{hoverable:!0,title:t,bordered:!1,style:{width:250},bodyStyle:{display:"flex",overflow:"hidden",padding:"1rem",minHeight:"8rem",maxHeight:"8rem"},children:(0,a.jsx)("p",{style:{margin:"0",overflow:"auto",overflowWrap:"break-word"},children:n})})})},o=n(1413),c=n(9439),l=n(1515),d=n(1243),u=n(668),m=n(3855),p=function(e){var t=e.isModalOpen,n=e.close,s=l.Z.useForm(),r=(0,c.Z)(s,1)[0],i=(0,m.I0)(),p=(0,m.I0)();return(0,a.jsx)(d.Z,{title:"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0433\u043e \u043f\u0440\u043e\u0435\u043a\u0442\u0430",centered:!0,open:t,onOk:r.submit,onCancel:function(){r.resetFields(),n()},children:(0,a.jsxs)(l.Z,(0,o.Z)((0,o.Z)({preserve:!1,form:r},{labelCol:{span:8},wrapperCol:{span:16}}),{},{name:"project",style:{maxWidth:600},validateMessages:{required:"${label} is required!"},onFinish:function(e){var t=e.project,s=void 0===t?{}:t,r=s.name,a=void 0===r?"":r,o=s.description;i({type:"addProject",payload:{projectName:a,projectDescription:void 0===o?"":o}}),p({type:"addProjectTasks",payload:{projectName:a}}),n()},children:[(0,a.jsx)(l.Z.Item,{name:["project","name"],label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",rules:[{required:!0}],children:(0,a.jsx)(u.Z,{})}),(0,a.jsx)(l.Z.Item,{name:["project","description"],label:"\u041a\u0440\u0430\u0442\u043a\u043e\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",children:(0,a.jsx)(u.Z.TextArea,{})})]}))})},f="tasksContainer_tasks-column-cont__cQIDY",h="tasksContainer_task-column__-fdI0",k="task_task-cont__PNZuU",x="task_task-title__KzE8K",j="task_task-start__VNPs3",v=n(3893),y=n(8218),Z=function(e){var t,n=e.id,s=e.title,r=e.start,i=e.activeId,c=e.priority,l=e.endDate,d=e.setOpenTaskDescriptionModal,u=(0,v.nB)({id:n}),m=u.attributes,p=u.listeners,f=u.setNodeRef,h=u.transform,Z=u.transition,g={transform:y.ux.Transform.toString(h),transition:Z},b=new Date(r).toLocaleString("ru",{day:"numeric",month:"numeric",year:"numeric",hour:"numeric",minute:"numeric"});l&&(t=new Date(l).toLocaleString("ru",{day:"numeric",month:"numeric",year:"numeric",hour:"numeric",minute:"numeric"}));var D=n===i;return(0,a.jsxs)("div",{style:{touchAction:"none"},children:[(0,a.jsx)("div",(0,o.Z)((0,o.Z)((0,o.Z)({ref:f,style:g},m),p),{},{children:(0,a.jsxs)("div",{onClick:d,className:"".concat(k),hidden:D,style:{backgroundColor:function(e){return 1===e?"rgb(211,254,171)":2===e?"rgb(248,251,167)":3===e?"rgb(235, 13, 13, 0.4)":"rgba(220, 216, 216, 0.6)"}(c)},children:[(0,a.jsx)("span",{className:x,children:s}),(0,a.jsx)("span",{className:j,children:"\u043d\u0430\u0447\u0430\u0442\u0430: ".concat(b)}),(0,a.jsx)("span",{className:j,children:l?"\u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430: ".concat(t):"\u043d\u0435 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430"})]})})),(0,a.jsx)("div",{style:{zIndex:"1",width:"5rem",background:"grey",height:"1.4rem",clipPath:"polygon(0% 0%, 100% 0%, 70% 100%, 0% 100%)",paddingLeft:"0.2rem",color:"white",cursor:"pointer"},onClick:function(){return d(n)},children:"\u043e\u0442\u043a\u0440\u044b\u0442\u044c"})]})},g=n(2791),b=n(618),D=n(1478),T=function(e){return e.reduserTascs},N=function(e){var t=e.projectName,n=e.setOpenTaskDescriptionModal,s=(0,b.v9)(T)[t],r=(0,g.useState)(null),i=(0,c.Z)(r,2),o=i[0],l=i[1],d=(0,m.I0)(),u=(0,D.Dy)((0,D.VT)(D.LO,{activationConstraint:{delay:250,tolerance:5}}),(0,D.VT)(D.we),(0,D.VT)(D.Lg,{coordinateGetter:v.is}));function p(e){return s.tasks[e].columnName}function k(e){var t;return(null===s||void 0===s||null===(t=s.columns[e])||void 0===t?void 0:t.tasks)||[]}return(0,a.jsx)(D.LB,{sensors:u,collisionDetection:D.pE,onDragEnd:function(e){var n=e.active,r=e.over;if("Quie"===r.id||"Develop"===r.id||"Done"===r.id){var a=JSON.parse(JSON.stringify(s)),i=r.id,o=n.id,c=p(o);return a.columns[c].tasks=a.columns[c].tasks.filter((function(e){return e!==o})),a.columns[i].tasks.push(o),a.tasks[o].columnName=i,a.tasks[o].endDate="Done"===i?new Date:"",void d({type:"updateTasks",payload:{projectName:t,newItems:a}})}if(r.id!==n.id&&s.tasks[r.id].columnName!==s.tasks[n.id].columnName){var l=JSON.parse(JSON.stringify(s)),u=p(r.id),m=n.id,f=p(m);return l.columns[f].tasks=l.columns[f].tasks.filter((function(e){return e!==m})),l.columns[u].tasks.push(m),l.tasks[m].columnName=u,void d({type:"updateTasks",payload:{projectName:t,newItems:l}})}if(r.id!==n.id&&s.tasks[r.id].columnName===s.tasks[n.id].columnName){var h=JSON.parse(JSON.stringify(s)),k=n.id,x=r.id,j=p(k),y=h.columns[j].tasks.findIndex((function(e){return e===x})),Z=h.columns[j].tasks.findIndex((function(e){return e===k})),g=(0,v.Rp)(h.columns[j].tasks,Z,y);return h.columns[j].tasks=g,void d({type:"updateTasks",payload:{projectName:t,newItems:h}})}},onDragStart:function(e){var t=e.active;l(t.id)},children:(0,a.jsxs)("div",{className:f,children:[(0,a.jsx)("div",{className:h,children:(0,a.jsx)(v.Fo,{items:k("Quie"),strategy:v.qw,children:(0,a.jsx)(C,{id:"Quie",children:k("Quie").map((function(e){return(0,a.jsx)(Z,{id:s.tasks[e].id,title:s.tasks[e].taskTitle,start:s.tasks[e].startDate,activeId:o,priority:s.tasks[e].priority,endDate:s.tasks[e].endDate,setOpenTaskDescriptionModal:n},s.tasks[e].id)}))})})}),(0,a.jsx)("div",{className:h,children:(0,a.jsx)(v.Fo,{items:k("Develop"),strategy:v.qw,children:(0,a.jsx)(C,{id:"Develop",children:k("Develop").map((function(e){return(0,a.jsx)(Z,{id:s.tasks[e].id,title:s.tasks[e].taskTitle,start:s.tasks[e].startDate,activeId:o,priority:s.tasks[e].priority,endDate:s.tasks[e].endDate,setOpenTaskDescriptionModal:n},s.tasks[e].id)}))})})}),(0,a.jsxs)("div",{className:h,children:[(0,a.jsx)(v.Fo,{items:k("Done"),strategy:v.qw,children:(0,a.jsx)(C,{id:"Done",children:k("Done").map((function(e){return(0,a.jsx)(Z,{id:s.tasks[e].id,title:s.tasks[e].taskTitle,start:s.tasks[e].startDate,activeId:o,priority:s.tasks[e].priority,endDate:s.tasks[e].endDate,setOpenTaskDescriptionModal:n},s.tasks[e].id)}))})}),(0,a.jsx)(D.y9,{children:o?(0,a.jsx)(Z,{id:o,title:s.tasks[o].title,start:s.tasks[o].start}):null})]})]})})};function C(e){var t=e.id,n=e.children,s=(0,D.Zj)({id:t}).setNodeRef;return(0,a.jsx)("div",{ref:s,children:n})}var I=n(4206),w=n(4586),S=n(6474),O=n(2641),_=n(2351),P=n(4261),F=function(e){var t=e.isModalOpen,n=e.close,s=e.projectName,r=l.Z.useForm(),i=(0,c.Z)(r,1)[0],p=(0,g.useState)(1),f=(0,c.Z)(p,2),h=f[0],k=f[1],x=(0,m.I0)(),j={name:"file",action:"https://run.mocky.io/v3/435e224c-44fb-4773-9faf-380c5e6a2188",headers:{authorization:"authorization-text"},onChange:function(e){"uploading"!==e.file.status&&console.log(e.file,e.fileList),"done"===e.file.status?I.ZP.success("".concat(e.file.name," file uploaded successfully")):"error"===e.file.status&&I.ZP.error("".concat(e.file.name," file upload failed."))}};return(0,a.jsx)(d.Z,{title:"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0438",centered:!0,open:t,onOk:i.submit,onCancel:function(){i.resetFields(),k(1),n()},children:(0,a.jsxs)(l.Z,(0,o.Z)((0,o.Z)({preserve:!1,form:i},{labelCol:{span:8},wrapperCol:{span:16}}),{},{name:"task",style:{maxWidth:600},validateMessages:{required:"${label} is required!",types:{email:"${label} is not a valid email!",number:"${label} is not a valid number!"},number:{range:"${label} must be between ${min} and ${max}"}},onFinish:function(e){var t=e.task,r=void 0===t?{}:t,a=r.name,o=void 0===a?"":a,c=r.description,l=void 0===c?"":c;x({type:"addTask",payload:{projectName:s,taskName:"task-".concat((0,P.Z)()),taskTitle:o,taskDescription:l,startDate:new Date,priority:h||1,endDate:"",duration:"",subTask:{},files:{},comments:{}}}),n(),i.resetFields(),k(1)},children:[(0,a.jsx)(l.Z.Item,{name:["task","name"],label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",rules:[{required:!0}],children:(0,a.jsx)(u.Z,{})}),(0,a.jsx)(l.Z.Item,{name:["task","description"],label:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",children:(0,a.jsx)(u.Z.TextArea,{})}),(0,a.jsx)(l.Z.Item,{children:(0,a.jsxs)("div",{style:{margin:"1rem"},children:[(0,a.jsx)("span",{style:{margin:"1rem"},children:"\u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442: "}),(0,a.jsxs)(w.ZP.Group,{onChange:function(e){k(e.target.value)},name:"radiogroup",value:h,children:[(0,a.jsx)(w.ZP,{value:1,children:"\u043d\u0438\u0437\u043a\u0438\u0439"}),(0,a.jsx)(w.ZP,{value:2,children:"\u0441\u0440\u0435\u0434\u043d\u0438\u0439"}),(0,a.jsx)(w.ZP,{value:3,children:"\u0432\u044b\u0441\u043e\u043a\u0438\u0439"})]})]})}),(0,a.jsx)(S.Z,(0,o.Z)((0,o.Z)({},j),{},{children:(0,a.jsx)(O.ZP,{icon:(0,a.jsx)(_.Z,{}),children:"Click to Upload"})}))]}))})}}}]);
//# sourceMappingURL=666.7e729188.chunk.js.map